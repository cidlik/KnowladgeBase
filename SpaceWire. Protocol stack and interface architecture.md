#spacewire 

*Note* Этот документ является, в некотором роде, вольным переводом-черновиком для соответствующего раздела из стандарта.

### Ссылки
1. [ECSS-E-ST-50-12C Rev.1](https://docs.elvees.com/display/ebib/SpaceWire+-+Links%2C+nodes%2C+routers+and+networks?preview=%2F16191723%2F16191724%2FECSS-E-ST-50-12C-Rev.1-DIR3_23Nov2015_.pdf)

Стек составляют следующие слои:
* сетевой (network);
* канальный (data link);
* кодирующий (encoding);
* физический (physical);
* управляющий(?) (managment).
<img src="D:\Programs\Obsidian.md\cidlik\KnowladgeBase\img\spw_stack.png" alt="spw_stack">

### Сетевой слой
Слой должен обеспечить следующие сервисы:
* пакетный сервис - должен принимать/отправлять пакеты из/в Сети(-ь).
* сервис временных меток - должен принимать/отправлять метки времени.
* сервис кодов распределенных прерываний - должен принимать/отправлять коды распределенных прерываний.
Сетевой слой должен использовать для всего этого сервисы канального слоя.
Сетевой слой получает запросы от пользовательского приложения.

### Канальный слой
Должен обеспечивать сервисы:
* N-Chars - нормальные символы;
* широковещательных кодов.
Слой должен:
* устанавливать связь в канале;
* управлять потоком информации;
* принимать/отправлять N-Chars;
* опционально принимать/отправлять широковещательные коды;
* закрывать соединение в канале после появления ошибок.

### Кодирующий слой
**Note** 
	В дальнейшем я буду использовать термины character и symbol, чтобы не использовать русское слово "символ" в обоих случаях. Это вынужденная мера, пока я не придумаю, как хорошо перевести эти слова.
	*character* - символ данных, например, как он представлен в памяти ПК.
	*symbol* - закодированный символ данных (character), закодированный управляющий символ (control character) или закодированный управляющий код.

Должен обеспечивать сервисы:
* кодирования characters:
	* кодировать characters и управляющие коды в symbols.
	* сериализовывать symbols (из параллельного представления, как в ячейках памяти, преобразовывать в последовательный поток бит).
	* стробирование symbols и подготовка к передаче на физическом уровне.
* декодирования characters:
	* восстановление битового потока данных из стробированного сигнала, полученного на физическом уровне.
	* десериализация битового потока.
	* декодирование symbols в characters.

### Физический слой
Должен обеспечивать сервисы:
* передачи;
* приёма.
Передающий сервис должен передавать данные и стробы, полученные из кодирующего слоя, по физическому слою. Аналогично с приёмным сервисом.
Приём и передача осуществляются на данном уровне по печатным дорожкам, коннекторам и кабелям.

### Архитектура порта SpaceWire
Порт должен включать:
* интерфейс порта;
* FIFO передатчика;
* FIFO приёмника;
* менеджер управления потоком;
* автомат состояний канала;
* передатчик;
* приёмник;
* пару драйверов передатчика;
* пару драйверов приёмника.
<img src="D:\Programs\Obsidian.md\cidlik\KnowladgeBase\img\spw_port_arch.png" alt="spw_port_arch">
Интерфейс порта должен включать:
* интерфейс приёма пакетов;
* интерфейс передачи пакетов;
* интерфейсы приёма и передачи временных меток и кодов распределенных прерываний.
Менеджер управления потоком должен управлять потоком данных в канале, предотвращая отправку данных, когда для них нет места в приёмном FIFO.
Автомат состояний канала должен управлять запуском канала и его восстановлением после ошибок.
Драйвера должны связывать данные и стробы и LVDS или LVTTL сигналы.